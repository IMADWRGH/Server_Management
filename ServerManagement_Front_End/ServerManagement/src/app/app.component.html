<div class="container-xl py-4">
  <!-- Card Wrapper -->
  <div class="card shadow-sm border-0">
    <div class="card-header bg-white border-0 py-3">
      <div
        class="d-flex flex-wrap align-items-center justify-content-between gap-2"
      >
        <h4 class="mb-0 fw-bold text-primary">
          <i class="material-icons align-middle me-1">storage</i> Manage Servers
        </h4>
        <div class="d-flex flex-wrap gap-2">
          <select name="status" class="form-select form-select-sm">
            <option value="ALL">All</option>
            <option value="SERVER_UP">SERVER UP</option>
            <option value="SERVER_DOWN">SERVER DOWN</option>
          </select>
          <button type="button" class="btn btn-outline-primary btn-sm">
            <i class="material-icons align-middle me-1">print</i> Print
          </button>
          <button
            class="btn btn-success btn-sm"
            data-bs-toggle="modal"
            data-bs-target="#addServerModal"
          >
            <i class="material-icons align-middle me-1">add_circle</i> New
            Server
          </button>
        </div>
      </div>
    </div>

    <!-- State Handling -->
    <div class="card-body p-0">
      <ng-container
        *ngIf="appState$ | async as appState"
        [ngSwitch]="appState.dataState"
      >
        <!-- Loading -->
        <ng-container *ngSwitchCase="DataState.LOADING_STATE">
          <div class="text-center py-5">
            <div class="spinner-border text-info" role="status"></div>
            <p class="mt-2 text-muted">Loading servers...</p>
          </div>
        </ng-container>

        <!-- Loaded -->
        <ng-container *ngSwitchCase="DataState.LOADED_STATE">
          <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
              <thead class="table-light">
                <tr>
                  <th>Image</th>
                  <th>IP Address</th>
                  <th>Name</th>
                  <th>Memory</th>
                  <th>Type</th>
                  <th>Status</th>
                  <th>Ping</th>
                  <th class="text-end">Actions</th>
                </tr>
              </thead>
              <tbody *ngFor="let server of appState.appData.data.servers; let i=index">
                <tr>
                  <td>
                    <img
                      [src]="server.imageUrl"
                      width="40"
                      height="40"
                      class="rounded-circle"
                      [alt]="server.name"
                    />
                  </td>
                  <td>{{server.ipAddress}}</td>
                  <td>{{server.name}}</td>
                  <td>{{server.memory}}</td>
                  <td>{{server.type}}</td>
                  <td>
                    <span class="badge"
                    [ngClass]="[server.status === Status.SERVER_UP ? 'badge-success' :'badge-danger']">
                    {{server.status  === Status.SERVER_UP ? 'SERVER UP' : 'SERVER DOWN'}}
                  </span></td>
                  <td>
                    <button
                      class="btn btn-link text-info p-0"
                      title="Ping Server"
                    >
                      <i class="material-icons">wifi_tethering</i>
                    </button>
                  </td>
                  <td class="text-end">
                    <button
                      class="btn btn-link text-danger p-0"
                      title="Delete Server"
                    >
                      <i class="material-icons">delete</i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </ng-container>

        <!-- Error -->
        <ng-container *ngSwitchCase="DataState.ERROR_STATE">
          <div class="alert alert-danger text-center m-0">
            <i class="material-icons align-middle me-1">error</i> Failed to load
            servers.
          </div>
        </ng-container>
      </ng-container>
    </div>
  </div>
</div>

<!-- Add Server Modal -->
<div class="modal fade" id="addServerModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow">
      <form>
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">
            <i class="material-icons align-middle me-1">add_circle</i> Add New
            Server
          </h5>
          <button
            type="button"
            class="btn-close btn-close-white"
            data-bs-dismiss="modal"
          ></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">IP Address</label>
            <input
              type="text"
              class="form-control"
              placeholder="e.g. 192.168.1.10"
              required
            />
          </div>
          <div class="mb-3">
            <label class="form-label">Server Name</label>
            <input
              type="text"
              class="form-control"
              placeholder="Server Name"
              required
            />
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Memory</label>
              <input
                type="text"
                class="form-control"
                placeholder="e.g. 8 GB"
                required
              />
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Type</label>
              <input
                type="text"
                class="form-control"
                placeholder="e.g. Dedicated"
                required
              />
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label">Status</label>
            <select class="form-select" required>
              <option value="SERVER_UP">SERVER UP</option>
              <option value="SERVER_DOWN">SERVER DOWN</option>
            </select>
          </div>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-light" data-bs-dismiss="modal">
            Cancel
          </button>
          <button type="submit" class="btn btn-primary">Add Server</button>
        </div>
      </form>
    </div>
  </div>
</div>
